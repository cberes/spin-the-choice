!function(e){"use strict";function n(e,n){var t,i;return void 0===n?(i=e,t=0):(i=n,t=e),Math.floor(Math.random()*i)+t}function t(){var n=[];this.register=function(e,n){this.registerCustom(e,function(e){e.textContent=n()})},this.registerCustom=function(t,i){n.push({id:t,element:e.getElementById(t),handler:i})},this.update=function(e){var t=void 0===e?n:n.filter(function(n){return e.indexOf(n.id)!==-1});t.forEach(function(e){e.handler(e.element)})}}function i(e,n){var t,i,o,r,s,c,u,a;this.reset=function(){t=[E.CHOICE,E.SPIN],i=null,o=0,r=e||0,s=0,c=n||0,u=0,a=[]},this.getActionsAllowed=function(){return t},this.setActionsAllowed=function(e){t=e},this.getChoice=function(){return i},this.setChoice=function(e){i=e},this.getChoicesMade=function(){return o},this.redeemChoice=function(){o+=1,this.addChoice(-1)},this.getChoicesRemaining=function(){return r},this.addChoice=function(e){r+=e||1,r<0&&(r=0)},this.getSpinsMade=function(){return s},this.redeemSpin=function(){s+=1,this.addSpin(-1)},this.getSpinsRemaining=function(){return c},this.addSpin=function(e){c+=e||1,c<0&&(c=0)},this.getPoints=function(){return u},this.addPoints=function(e){u+=e},this.getPrizes=function(){return a},this.addPrize=function(e){a.push(e)},this.getTotalScore=function(){return a.map(function(e){return e.getPoints()}).reduce(function(e,n){return e+n},u)},this.reset()}function o(e,n,t,i){this.getId=function(){return e},this.getName=function(){return n},this.update=function(e){t(e)},this.getActionsAllowed=function(){return i}}function r(e,n,t){this.getId=function(){return e},this.getName=function(){return n},this.getPoints=function(){return t}}function s(e,n,t,i){this.getId=function(){return e},this.getName=function(){return n},this.getPoints=function(){return t},this.update=i||function(i){i.addPrize(new r(e,n,t))}}function c(e){var n=e||0;this.getPoints=function(){return n},this.addPoints=function(e){n+=e},this.reset=function(){n=0}}function u(e,t){function i(e){return e>15?50:e>5?100:e>1?250:500}function o(n,s){r=(r+1)%e.length,0===n?s(e[r]):(t(),setTimeout(o,i(n),n-1,s))}var r=0;this.getResult=function(){return e[r]},this.spin=function(t){var i=4*e.length+n(e.length);o(i,t)}}function a(e,n,t,i,o){function r(){var e=[];return i.getChoicesRemaining()>0&&e.push(E.CHOICE),i.getSpinsRemaining()>0&&e.push(E.SPIN),0===e.length&&e.push(E.GAME_OVER),e}function s(e){var n=e.getActionsAllowed();return void 0===n?r():"function"==typeof n?n(i):n}function c(n,r){i.setActionsAllowed([]),n(),e.spin(function(e){e.update(i),i.setActionsAllowed(s(e)),t.addPoints(o||1),r()})}this.choose=function(e,n){i.setChoice(w.CHOICE),i.redeemChoice(),c(e,n)},this.spin=function(e,n){i.setChoice(w.SPIN),i.redeemSpin(),c(e,n)},this.spinPrizeWheel=function(e,t){i.setActionsAllowed([]),e(),n.spin(function(e){e.update(i),i.setActionsAllowed(r()),t()})}}function d(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function h(n,t){var i=e.createElement(n);return i.textContent=t,i}function f(e,n){return function(t){var i=t.getChoice()===e?1:-1;t.addPoints(i*n)}}function g(e){return function(){var n=e.getResult();return n&&n.getName()||""}}function l(e,n){return function(t){t.disabled=e.getActionsAllowed().indexOf(n)===-1}}function p(){e.cookie="intro_closed=true; max-age=2592000"}function C(){return"true"===e.cookie.replace(/(?:(?:^|.*;\s*)intro_closed\s*\=\s*([^;]*).*$)|^.*$/,"$1")}function m(){var n=new c(0),r=new Audio("assets/sound/bell.ogg"),C=new t,m=function(){C.update(["choose","spin","prize-wheel","new-game"])},v=new i(3,3),I=[new o("spin","Spin",f(w.SPIN,100)),new o("choice","Choice",f(w.CHOICE,100)),new o("lose_spin","Lose a Spin",function(e){e.addSpin(-1)}),new o("spin_again","Spin Again",function(e){e.getChoice()===w.CHOICE?e.addChoice():e.addSpin()},function(e){return[e.getChoice()]}),new o("prize","Prize Wheel",function(){r.play()},[E.PRIZE_WHEEL]),new o("free_spin","Free Spin",function(e){e.addSpin()}),new o("lose_choice","Lose a Choice",function(e){e.addChoice(-1)}),new o("free_choice","Free Choice",function(e){e.addChoice()})],P=[new s("free_spin","Free Spin",0,function(e){e.addSpin()}),new s("winnebago","Winnebago",1e4),new s("free_choice","Free Choice",0,function(e){e.addChoice()}),new s("washer_dryer","Washer Dryer",1e3),new s("mazda","Mazda",5e3),new s("microwave","Microwave Oven",500),new s("points","Point Bank",0,function(e){e.addPoints(n.getPoints()),n.reset()}),new s("mercedes","Mercedes",7500)],S=new u(I,function(){C.update(["wheel-outcome"])}),A=new u(P,function(){C.update(["prize-outcome"])}),_=new a(S,A,n,v,10);C.register("choices-made",v.getChoicesMade),C.register("choices-remaining",v.getChoicesRemaining),C.register("spins-made",v.getSpinsMade),C.register("spins-remaining",v.getSpinsRemaining),C.register("points-accrued",v.getTotalScore),C.register("points-bank",n.getPoints),C.register("wheel-outcome",g(S)),C.register("prize-outcome",g(A)),C.registerCustom("prizes-earned",function(e){var n,t,i=v.getPrizes();if(d(e),i.length)for(t=0;t<i.length;t+=1)n=h("li",i[t].getName()),n.className="list-group-item",e.appendChild(n);else n=h("li","None"),n.className="list-group-item placeholder",e.appendChild(n)}),C.registerCustom("choose",l(v,E.CHOICE)),C.registerCustom("spin",l(v,E.SPIN)),C.registerCustom("prize-wheel",l(v,E.PRIZE_WHEEL)),C.registerCustom("new-game",l(v,E.GAME_OVER)),e.getElementById("choose").addEventListener("click",function(e){_.choose(m,C.update),e.preventDefault()}),e.getElementById("spin").addEventListener("click",function(e){_.spin(m,C.update),e.preventDefault()}),e.getElementById("prize-wheel").addEventListener("click",function(e){_.spinPrizeWheel(m,C.update),e.preventDefault()}),e.getElementById("new-game").addEventListener("click",function(e){v.reset(),C.update(),e.preventDefault()}),e.getElementById("close-intro").addEventListener("click",function(n){e.getElementById("intro").hidden=!0,p(),n.preventDefault()}),C.update()}var w={CHOICE:"choice",SPIN:"spin",values:function(){return[this.CHOICE,this.SPIN]}},E={CHOICE:w.CHOICE,SPIN:w.SPIN,PRIZE_WHEEL:"prize_wheel",GAME_OVER:"game_over",values:function(){return[this.CHOICE,this.SPIN,this.PRIZE_WHEEL,this.GAME_OVER]}};e.onreadystatechange=function(){"interactive"===e.readyState&&(e.getElementById("intro").hidden=C(),m())}}(document);