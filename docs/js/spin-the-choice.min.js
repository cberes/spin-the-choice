!function(e){"use strict";function n(e,n){var t,i;return void 0===n?(i=e,t=0):(i=n,t=e),Math.floor(Math.random()*i)+t}function t(){var n=[];this.register=function(e,n){this.registerCustom(e,function(e){e.textContent=n()})},this.registerCustom=function(t,i){n.push({element:e.getElementById(t),handler:i})},this.update=function(){var e;for(e=0;e<n.length;e+=1)n[e].handler(n[e].element)}}function i(e,n){var t,i,o,s,r,c,u,d;this.reset=function(){t=[C.CHOICE,C.SPIN],i=null,o=0,s=e||0,r=0,c=n||0,u=0,d=[]},this.getActionsAllowed=function(){return t},this.setActionsAllowed=function(e){t=e},this.getChoice=function(){return i},this.setChoice=function(e){i=e},this.getChoicesMade=function(){return o},this.redeemChoice=function(){o+=1,s-=1},this.getChoicesRemaining=function(){return s},this.addChoice=function(e){s+=e||1},this.getSpinsMade=function(){return r},this.redeemSpin=function(){r+=1,c-=1},this.getSpinsRemaining=function(){return c},this.addSpin=function(e){c+=e||1},this.getPoints=function(){return u},this.addPoints=function(e){u+=e},this.getPrizes=function(){return d},this.addPrize=function(e){d.push(e)},this.reset()}function o(e,n,t,i){this.getId=function(){return e},this.getName=function(){return n},this.update=function(e){t(e)},this.getActionsAllowed=function(){return i}}function s(e,n,t){this.getId=function(){return e},this.getName=function(){return n},this.getPoints=function(){return t}}function r(e,n,t,i){this.getId=function(){return e},this.getName=function(){return n},this.getPoints=function(){return t},this.update=i||function(i){i.addPrize(new s(e,n,t))}}function c(e){var n=e||0;this.getPoints=function(){return n},this.addPoints=function(e){n+=e},this.reset=function(){n=0}}function u(e){var t=e[0];this.getResult=function(){return t},this.spin=function(i){var o=n(e.length);t=e[o],i(t)}}function d(e,n,t,i,o){function s(){var e=[];return i.getChoicesRemaining()>0&&e.push(C.CHOICE),i.getSpinsRemaining()>0&&e.push(C.SPIN),0===e.length&&e.push(C.GAME_OVER),e}function r(n){i.setActionsAllowed([]),e.spin(function(e){e.update(i),i.setActionsAllowed(e.getActionsAllowed()||s()),t.addPoints(o||1),n()})}this.choose=function(e){i.setChoice(m.CHOICE),i.redeemChoice(),r(e)},this.spin=function(e){i.setChoice(m.SPIN),i.redeemSpin(),r(e)},this.spinPrizeWheel=function(e){i.setActionsAllowed([]),n.spin(function(n){n.update(i),i.setActionsAllowed(s()),e()})}}function a(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function h(n,t){var i=e.createElement(n);return i.textContent=t,i}function f(e,n){return function(t){var i=t.getChoice()===e?1:-1;t.addPoints(i*n)}}function g(e){return function(){var n=e.getResult();return n&&n.getName()||""}}function l(e,n){return function(t){t.disabled=e.getActionsAllowed().indexOf(n)===-1}}function p(){var e=new c(0),n=new Audio("assets/sound/bell.ogg"),s=new t,p=new i(3,3),w=[new o("spin","Spin",f(m.SPIN,100)),new o("choice","Choice",f(m.CHOICE,100)),new o("lose_spin","Lose a Spin",function(e){e.addSpin(-1)}),new o("spin_again","Spin Again",function(e){e.addSpin()},[C.SPIN]),new o("prize","Prize Wheel",function(){n.play()},[C.PRIZE_WHEEL]),new o("free_spin","Free Spin",function(e){e.addSpin()}),new o("lose_choice","Lose a Choice",function(e){e.addChoice(-1)}),new o("free_choice","Free Choice",function(e){e.addChoice()})],E=[new r("free_spin","Free Spin",0,function(e){e.addSpin()}),new r("winnebago","Winnebago",1e4),new r("free_choice","Free Choice",0,function(e){e.addChoice()}),new r("washer_dryer","Washer Dryer",1e3),new r("mazda","Mazda",5e3),new r("microwave","Microwave Oven",500),new r("points","Point Bank",0,function(n){n.addPoints(e.getPoints()),e.reset()}),new r("mercedes","Mercedes",7500)],I=new u(w),P=new u(E),v=new d(I,P,e,p,10);s.register("choices-made",p.getChoicesMade),s.register("choices-remaining",p.getChoicesRemaining),s.register("spins-made",p.getSpinsMade),s.register("spins-remaining",p.getSpinsRemaining),s.register("points-accrued",p.getPoints),s.register("points-bank",e.getPoints),s.register("wheel-outcome",g(I)),s.register("prize-outcome",g(P)),s.registerCustom("prizes-earned",function(e){var n,t,i=p.getPrizes();if(a(e),i.length)for(t=0;t<i.length;t+=1)n=h("li",i[t].getName()),n.className="list-group-item",e.appendChild(n);else n=h("li","None"),n.className="list-group-item placeholder",e.appendChild(n)}),s.registerCustom("choose",l(p,C.CHOICE)),s.registerCustom("spin",l(p,C.SPIN)),s.registerCustom("prize-wheel",l(p,C.PRIZE_WHEEL)),s.registerCustom("new-game",l(p,C.GAME_OVER)),document.getElementById("choose").addEventListener("click",function(e){v.choose(function(){s.update()}),e.preventDefault()}),document.getElementById("spin").addEventListener("click",function(e){v.spin(function(){s.update()}),e.preventDefault()}),document.getElementById("prize-wheel").addEventListener("click",function(e){v.spinPrizeWheel(function(){s.update()}),e.preventDefault()}),document.getElementById("new-game").addEventListener("click",function(e){p.reset(),s.update(),e.preventDefault()}),document.getElementById("close-intro").addEventListener("click",function(e){document.getElementById("intro").hidden=!0,e.preventDefault()}),s.update()}var m={CHOICE:"choice",SPIN:"spin",values:function(){return[this.CHOICE,this.SPIN]}},C={CHOICE:m.CHOICE,SPIN:m.SPIN,PRIZE_WHEEL:"prize_wheel",GAME_OVER:"game_over",values:function(){return[this.CHOICE,this.SPIN,this.PRIZE_WHEEL,this.GAME_OVER]}};e.onreadystatechange=function(){"interactive"===e.readyState&&p()}}(document);